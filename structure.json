{
  "public": {
    "index.html": "<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>Búsqueda de Recetas - DofusDB</title>\r\n  <link rel=\"stylesheet\" href=\"css/style.css\">\r\n  <link rel=\"icon\" href=\"favicon.ico\" type=\"image/x-icon\">\r\n</head>\r\n<body>\r\n  <h1>Búsqueda de Recetas en DofusDB</h1>\r\n\r\n  <!-- Formulario de búsqueda -->\r\n  <form id=\"searchForm\">\r\n    <label for=\"objectName\">Nombre del objeto:</label>\r\n    <input type=\"text\" id=\"objectName\" placeholder=\"Buscar receta\" required>\r\n    <button type=\"submit\">Buscar</button>\r\n  </form>\r\n\r\n  <!-- Contenedor principal -->\r\n  <main>\r\n    <!-- Contenedor de resultados principales -->\r\n    <section id=\"results\">Introduce un nombre para buscar.</section>\r\n\r\n    <!-- Contenedor de detalles de la receta -->\r\n    <section id=\"recipeDetails\">\r\n      <h2 id=\"nombreObjeto\"></h2>\r\n\r\n      \r\n  </main>\r\n  <script type=\"module\" src=\"js/calculo.js\"></script>\r\n  <script type=\"module\" src=\"js/search.js\"></script>\r\n  <script type=\"module\" src=\"js/render.js\"></script>\r\n  \r\n\r\n</body>\r\n</html>\r\n",
    "js": {
      "calculo.js": "export function calcularGanancia() {\r\n  let totalGasto = 0;\r\n  \r\n  // Obtener la cantidad de objetos a fabricar\r\n  const cantidadFabricarInput = document.getElementById(\"cantidadFabricar\");\r\n  const cantidadFabricar = cantidadFabricarInput ? parseInt(cantidadFabricarInput.value) || 1 : 1;\r\n  \r\n  console.log(`[DEBUG] Cantidad a fabricar: ${cantidadFabricar}`);\r\n\r\n  // Verificar que la sección de ingredientes existe antes de acceder a sus datos\r\n  const ingredientesElement = document.getElementById(\"ingredientes\");\r\n  if (!ingredientesElement || !ingredientesElement.dataset.ingredientes) {\r\n    console.warn(\"[WARNING] No se encontraron ingredientes en el dataset.\");\r\n    return;\r\n  }\r\n\r\n  // Obtener los ingredientes desde el dataset\r\n  const ingredientes = JSON.parse(ingredientesElement.dataset.ingredientes || \"[]\");\r\n  console.log(\"[DEBUG] Ingredientes cargados:\", ingredientes);\r\n\r\n  let ingredientesTotalesHTML = \"\";\r\n\r\n  ingredientes.forEach(ingrediente => {\r\n    // Verificar si el input de precio del ingrediente existe\r\n    const inputPrecio = document.getElementById(`precio-${ingrediente.id}`);\r\n    \r\n    if (!inputPrecio) {\r\n      console.warn(`[WARNING] No se encontró el input para el ingrediente: ${ingrediente.name}`);\r\n      return;\r\n    }\r\n\r\n    // Obtener el precio unitario ingresado por el usuario\r\n    const precioUnitario = parseFloat(inputPrecio.value) || 0;\r\n    console.log(`[DEBUG] Precio de ${ingrediente.name}: ${precioUnitario} K`);\r\n\r\n    // Calcular el costo total del ingrediente\r\n    totalGasto += precioUnitario * ingrediente.quantity;\r\n\r\n    // Calcular cantidad total de ingredientes requeridos según la cantidad a fabricar\r\n    const cantidadTotal = ingrediente.quantity * cantidadFabricar;\r\n    ingredientesTotalesHTML += `\r\n      <li>\r\n        <img src=\"${ingrediente.image}\" alt=\"${ingrediente.name}\" style=\"width: 40px; height: 40px; vertical-align: middle;\" />\r\n        ${ingrediente.name}: <strong>${cantidadTotal}</strong> unidades\r\n      </li>\r\n    `;\r\n  });\r\n\r\n  // Verificar si el input del precio del objeto existe antes de obtener su valor\r\n  const precioObjetoInput = document.getElementById(\"precioObjeto\");\r\n  const precioObjeto = precioObjetoInput ? parseFloat(precioObjetoInput.value) || 0 : 0;\r\n  \r\n  console.log(\"[DEBUG] Precio del objeto:\", precioObjeto);\r\n\r\n  // Calcular la ganancia correctamente\r\n  const ganancia = (precioObjeto * cantidadFabricar) - totalGasto;\r\n  const gananciaTotal = ganancia; // Ya se multiplica arriba por la cantidad a fabricar\r\n\r\n  // Actualizar los valores en la interfaz\r\n  const totalGastoElement = document.getElementById(\"totalGasto\");\r\n  if (totalGastoElement) totalGastoElement.textContent = totalGasto + \" K\";\r\n\r\n  const gananciaElement = document.getElementById(\"ganancia\");\r\n  if (gananciaElement) gananciaElement.textContent = ganancia + \" K\";\r\n\r\n  const gananciaTotalElement = document.getElementById(\"gananciaTotal\");\r\n  if (gananciaTotalElement) gananciaTotalElement.textContent = gananciaTotal + \" K\";\r\n\r\n  const ingredientesTotalesElement = document.getElementById(\"ingredientesTotales\");\r\n  if (ingredientesTotalesElement) ingredientesTotalesElement.innerHTML = ingredientesTotalesHTML;\r\n\r\n  console.log(\"[DEBUG] Cálculo completado: Gasto total:\", totalGasto, \"K | Ganancia:\", ganancia, \"K | Ganancia Total:\", gananciaTotal, \"K\");\r\n}\r\n",
      "render.js": "import { calcularGanancia } from './calculo.js';\r\n\r\n// Función para renderizar listas de efectos\r\nexport const renderEffects = (effects) => {\r\n  if (!effects || effects.length === 0) {\r\n    return \"<li>Sin efectos disponibles</li>\";\r\n  }\r\n  return effects\r\n    .map(\r\n      (effect) =>\r\n        `<li>${effect.characteristic || \"Efecto desconocido\"}: ${effect.from || 0} a ${effect.to || 0}</li>`\r\n    )\r\n    .join(\"\");\r\n};\r\n\r\n// Función para renderizar la receta en el frontend con inputs de precios\r\nexport const renderRecipe = (recipe) => {\r\n  if (!recipe || recipe.length === 0) {\r\n    return \"<li>Receta no disponible</li>\";\r\n  }\r\n  return recipe.map(ingredient => `\r\n    <li>\r\n      <img src=\"${ingredient.image}\" alt=\"${ingredient.name}\" style=\"width: 40px; height: 40px; vertical-align: middle;\" />\r\n      ${ingredient.name} (Cantidad: ${ingredient.quantity || \"N/A\"})\r\n      <input type=\"number\" class=\"price-input\" id=\"precio-${ingredient.id}\" placeholder=\"Precio por unidad\" oninput=\"calcularGanancia()\">\r\n    </li>\r\n  `).join(\"\");\r\n};\r\n",
      "search.js": "import { renderRecipe } from './render.js';\r\nimport { calcularGanancia } from './calculo.js';\r\n\r\nconst form = document.getElementById('searchForm');\r\nconst resultsDiv = document.getElementById('results');\r\n\r\n// Agregamos un evento para manejar el envío del formulario\r\nform.addEventListener(\"submit\", async (e) => {\r\n  e.preventDefault();\r\n\r\n  const objectName = document.getElementById(\"objectName\").value.trim();\r\n  console.log(\"Nombre del objeto enviado:\", objectName);\r\n\r\n  if (!objectName) {\r\n    resultsDiv.innerHTML =\r\n      '<p style=\"color: red;\">Por favor, ingresa el nombre de un objeto.</p>';\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // Mostrar mensaje de búsqueda\r\n    resultsDiv.innerHTML = \"<p>Buscando...</p>\";\r\n\r\n    // Realizar la solicitud al servidor\r\n    const response = await fetch(\"/api/recipes/search\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ objectName }),\r\n    });\r\n\r\n    // Parsear la respuesta JSON\r\n    const data = await response.json();\r\n\r\n    if (data.success && data.data) {\r\n      const item = data.data;\r\n      console.log(\"Datos recibidos del servidor:\", item);\r\n\r\n      // Renderizar el objeto con la receta y los inputs de precio\r\n      resultsDiv.innerHTML = `\r\n        <h2>${item.name || \"Nombre no disponible\"}</h2>\r\n        \r\n        <h3>Precio de Venta:</h3>\r\n        <input type=\"number\" id=\"precioObjeto\" class=\"price-input\" placeholder=\"Ingrese precio\" oninput=\"calcularGanancia()\">\r\n\r\n        <h3>Receta:</h3>\r\n        <ul id=\"ingredientes\">${renderRecipe(item.recipe)}</ul>\r\n\r\n        <h3>Total Gasto: <span id=\"totalGasto\">0</span> K</h3>\r\n        <h3>Ganancia: <span id=\"ganancia\">0</span> K</h3>\r\n\r\n        <label>Cantidad a fabricar:\r\n          <input type=\"number\" id=\"cantidadFabricar\" value=\"1\" min=\"1\" class=\"price-input\" oninput=\"calcularGanancia()\">\r\n        </label>\r\n\r\n        <h3>Ganancia Total: <span id=\"gananciaTotal\">0</span> K</h3>\r\n\r\n        <h3>Ingredientes Totales Necesarios:</h3>\r\n        <ul id=\"ingredientesTotales\"></ul>\r\n      `;\r\n\r\n      // Guardar ingredientes en dataset para cálculos\r\n      document.getElementById(\"ingredientes\").dataset.ingredientes = JSON.stringify(item.recipe);\r\n\r\n    } else {\r\n      // Mostrar mensaje si no hay resultados\r\n      resultsDiv.innerHTML =\r\n        \"<p>No se encontraron resultados para tu búsqueda.</p>\";\r\n      console.log(\"Respuesta sin datos:\", data);\r\n    }\r\n  } catch (error) {\r\n    // Manejo de errores en la solicitud\r\n    console.error(\"Error en la búsqueda:\", error);\r\n    resultsDiv.innerHTML =\r\n      '<p style=\"color: red;\">Hubo un error al realizar la búsqueda. Inténtalo de nuevo más tarde.</p>';\r\n  }\r\n});\r\n"
    }
  }
}